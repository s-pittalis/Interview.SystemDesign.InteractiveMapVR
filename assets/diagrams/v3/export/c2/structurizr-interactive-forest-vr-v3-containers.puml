@startuml
title <size:24>Container View: Interactive Forest VR System</size>

set separator none
left to right direction
skinparam ranksep 60
skinparam nodesep 30
hide stereotype

<style>
  root {
    BackgroundColor: #ffffff;
    FontColor: #444444;
  }
  // Element
  .Element-RWxlbWVudA== {
    BackgroundColor: #ffffff;
    LineColor: #444444;
    LineStyle: 0;
    LineThickness: 2;
    FontColor: #444444;
    FontSize: 24;
    HorizontalAlignment: center;
    Shadowing: 0;
    MaximumWidth: 450;
  }
  // Relationship
  .Relationship-UmVsYXRpb25zaGlw {
    LineThickness: 2;
    LineStyle: 10-10;
    LineColor: #444444;
    FontColor: #444444;
    FontSize: 24;
  }
  // Interactive Forest VR System
  .Boundary-SW50ZXJhY3RpdmUgRm9yZXN0IFZSIFN5c3RlbQ== {
    BackgroundColor: #ffffff;
    LineColor: #444444;
    LineStyle: 0;
    LineThickness: 2;
    FontColor: #444444;
    FontSize: 24;
    HorizontalAlignment: center;
    Shadowing: 0;
  }
</style>

rectangle "==VR User\n<size:16>[Person]</size>\n\nParticipant using Meta Quest 3 headset." <<Element-RWxlbWVudA==>> as VRUser
rectangle "==Photon Cloud Relay\n<size:16>[Software System]</size>\n\nShared Mode relay between clients." <<Element-RWxlbWVudA==>> as PhotonCloudRelay
rectangle "==Meta Shared Spatial Anchors\n<size:16>[Software System]</size>\n\nCloud-based anchor alignment service." <<Element-RWxlbWVudA==>> as MetaSharedSpatialAnchors
rectangle "==MapTiler or Maps3D.io\n<size:16>[Software System]</size>\n\nProvides 3D map tiles or GLTF/OBJ static exports." <<Element-RWxlbWVudA==>> as MapTilerorMaps3Dio

rectangle "Interactive Forest VR System\n<size:16>[Software System]</size>" <<Boundary-SW50ZXJhY3RpdmUgRm9yZXN0IFZSIFN5c3RlbQ==>> {
  rectangle "==Backend (FastAPI)\n<size:16>[Container: Handles auth, session registry, webhooks, and persistence via REST.]</size>\n\nPython 3.x FastAPI app" <<Element-RWxlbWVudA==>> as InteractiveForestVRSystem.BackendFastAPI
  rectangle "==Database (PostgreSQL)\n<size:16>[Container: PostgreSQL 13+]</size>\n\nStores users, sessions, and JSONB snapshots." <<Element-RWxlbWVudA==>> as InteractiveForestVRSystem.DatabasePostgreSQL
  rectangle "==Observability Stack\n<size:16>[Container: Metrics, structured logs, dashboards.]</size>\n\nPrometheus + Grafana" <<Element-RWxlbWVudA==>> as InteractiveForestVRSystem.ObservabilityStack
  rectangle "==VPN Gateway\n<size:16>[Container: Secures remote maintenance.]</size>\n\nWireGuard or OpenVPN" <<Element-RWxlbWVudA==>> as InteractiveForestVRSystem.VPNGateway
  rectangle "==Unity Client\n<size:16>[Container: Synchronizes state, performs autosave if leader.]</size>\n\nMeta Quest 3 app using Photon Fusion Shared Mode" <<Element-RWxlbWVudA==>> as InteractiveForestVRSystem.UnityClient
}

VRUser --> InteractiveForestVRSystem.UnityClient <<Relationship-UmVsYXRpb25zaGlw>> : "Uses"
InteractiveForestVRSystem.UnityClient --> PhotonCloudRelay <<Relationship-UmVsYXRpb25zaGlw>> : "Connects via Photon Cloud Relay (real-time sync)"
InteractiveForestVRSystem.UnityClient --> InteractiveForestVRSystem.BackendFastAPI <<Relationship-UmVsYXRpb25zaGlw>> : "Calls REST APIs (login, save, refresh token)"
InteractiveForestVRSystem.BackendFastAPI --> InteractiveForestVRSystem.DatabasePostgreSQL <<Relationship-UmVsYXRpb25zaGlw>> : "Persists session and snapshot data (JSONB)"
InteractiveForestVRSystem.BackendFastAPI --> InteractiveForestVRSystem.ObservabilityStack <<Relationship-UmVsYXRpb25zaGlw>> : "Exposes metrics / structured logs"
InteractiveForestVRSystem.BackendFastAPI --> InteractiveForestVRSystem.VPNGateway <<Relationship-UmVsYXRpb25zaGlw>> : "Admin access (VPN only)"
InteractiveForestVRSystem.UnityClient --> MetaSharedSpatialAnchors <<Relationship-UmVsYXRpb25zaGlw>> : "Creates / resolves spatial anchors"
InteractiveForestVRSystem.UnityClient --> MapTilerorMaps3Dio <<Relationship-UmVsYXRpb25zaGlw>> : "Loads 3D maps and overlays"

@enduml